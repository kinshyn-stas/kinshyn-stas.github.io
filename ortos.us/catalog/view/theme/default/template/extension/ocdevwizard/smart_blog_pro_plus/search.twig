{{ header }}
<div class="container">
	<ul class="breadcrumb">
		{% set b_i = 1 %}
		{% for breadcrumb in breadcrumbs %}
		<li>
			{% if (b_i < (breadcrumbs|length)) %}
				<a href="{{ breadcrumb['href'] }}"><span>{{ breadcrumb['text'] }}</span></a>
			{% else %}
				<span>{{ breadcrumb['text'] }}</span>
			{% endif %}
		</li>
		{% set b_i = b_i + 1 %}
		{% endfor %}
	</ul>
  <div class="row">
    {{ column_left }}
    {% if (column_left and column_right) %}
      {% set class = 'col-sm-6' %}
    {% elseif (column_left or column_right) %}
      {% set class = 'col-sm-9' %}
    {% else %}
      {% set class = 'col-sm-12' %}
    {% endif %}
    <div id="content" class="{{ class }} {{ _code }}-content">
      {{ content_top }}
      <h1>{{ heading_title }}</h1>
      <label class="control-label" for="input-search">{{ entry_search }}</label>
      <div class="row">
        <div class="col-sm-4">
          <input type="text" name="search" value="{{ search }}" placeholder="{{ entry_search }}" id="input-search" class="form-control"/>
          <label class="checkbox-inline">
            {% if (sub_category) %}
              <input type="checkbox" name="sub_category" value="1" checked="checked"/>
            {% else %}
              <input type="checkbox" name="sub_category" value="1"/>
            {% endif %}
            {{ text_sub_category }}
          </label>
          <br/>
          <label class="checkbox-inline">
            {% if (description) %}
              <input type="checkbox" name="description" value="1" id="description" checked="checked"/>
            {% else %}
              <input type="checkbox" name="description" value="1" id="description"/>
            {% endif %}
            {{ entry_description }}
          </label>
        </div>
        <div class="col-sm-3">
          <select name="category_id" class="form-control">
            <option value="0">{{ text_category }}</option>
            {% for category_1 in categories %}
              {% if (category_1['category_id'] == category_id) %}
                <option value="{{ category_1['category_id'] }}" selected="selected">{{ category_1['name'] }}</option>
              {% else %}
                <option value="{{ category_1['category_id'] }}">{{ category_1['name'] }}</option>
              {% endif %}
              {% for category_2 in category_1['children'] %}
                {% if (category_2['category_id'] == category_id) %}
                  <option value="{{ category_2['category_id'] }}" selected="selected">&nbsp;&nbsp;{{ category_2['name'] }}</option>
                {% else %}
                  <option value="{{ category_2['category_id'] }}">&nbsp;&nbsp;{{ category_2['name'] }}</option>
                {% endif %}
                {% for category_3 in category_2['children'] %}
                  {% if (category_3['category_id'] == category_id) %}
                    <option value="{{ category_3['category_id'] }}" selected="selected">&nbsp;&nbsp;&nbsp;&nbsp;{{ category_3['name'] }}</option>
                  {% else %}
                    <option value="{{ category_3['category_id'] }}">&nbsp;&nbsp;&nbsp;&nbsp;{{ category_3['name'] }}</option>
                  {% endif %}
                {% endfor %}
              {% endfor %}
            {% endfor %}
          </select>
        </div>
        <div class="col-sm-3">
          <input type="button" value="{{ button_search }}" id="button-search" class="btn btn-primary"/>
        </div>
      </div>
      <h2>{{ text_search }}</h2>
      {% if (posts) %}
        <div class="row">
          <div class="col-md-7" {% if (not show_disaply_view_on_search) %}style="display:none;"{% endif %}>
            <div class="btn-group">
              <button type="button" id="list-view" class="btn btn-default" data-toggle="tooltip" title="{{ button_list }}"><i class="fa fa-th-list"></i></button>
              <button type="button" id="grid-view" class="btn btn-default" data-toggle="tooltip" title="{{ button_grid }}"><i class="fa fa-th"></i></button>
            </div>
          </div>
          {% if (show_sort_on_search) %}
            <div class="col-md-3">
              <div class="input-group">
                <span class="input-group-addon">{{ text_sort }}</span>
                <select id="input-sort" class="form-control col-sm-3" onchange="location = this.value;">
                  {% for sorts in sorts %}
	                  {% if (sorts['value'] == sort ~ '-' ~ order) %}
	                    <option value="{{ sorts['href'] }}" selected="selected">{{ sorts['text'] }}</option>
	                  {% else %}
	                    <option value="{{ sorts['href'] }}">{{ sorts['text'] }}</option>
	                  {% endif %}
                  {% endfor %}
                </select>
              </div>
            </div>
          {% endif %}{% if (show_limit_on_search) %}
            <div class="col-md-2">
              <div class="input-group">
                <span class="input-group-addon">{{ text_limit }}</span>
                <select id="input-limit" class="form-control" onchange="location = this.value;">
                  {% for limits in limits %}
	                  {% if (limits['value'] == limit) %}
	                    <option value="{{ limits['href'] }}" selected="selected">{{ limits['text'] }}</option>
	                  {% else %}
	                    <option value="{{ limits['href'] }}">{{ limits['text'] }}</option>
                    {% endif %}
                  {% endfor %}
                </select>
              </div>
            </div>
          {% endif %}
        </div>
        <br/>
        <div class="row">
          {% for post in posts %}
            <div class="product-layout product-list col-xs-12">
              <div class="product-thumb transition {{ _code }}-post-item">
                {% if (show_image_on_search) %}
                  {% if (post['show_main_image'] == 1) %}
                    <div class="image">
                      <a href="{{ post['href'] }}"><img src="{{ post['image'] }}" alt="{{ post['name'] }}" title="{{ post['name'] }}" class="img-responsive"/></a>
                    </div>
                  {% endif %}{% if (post['video'] and post['show_main_image'] == 2) %}
                  <div class="video">
                    <div class="video-inner {{ _code }}-youtube" onclick="show_youtube('{{ post['video'] }}', this);" style="background-image:url('https://img.youtube.com/vi/{{ post['video'] }}/0.jpg');">
                      <div>
                        <i class="fa fa-play"></i>
	                      <span></span>
	                      <span></span>
                      </div>
                    </div>
                  </div>
                {% endif %}
                {% endif %}
                <div class="caption">
                  <a class="{{ _code }}-post-heading" href="{{ post['href'] }}">{{ post['name'] }}</a>
                  {% if (post['author'] and show_author_on_search) %}
                    <b>{{ post['author'] }}</b> - {% endif %}{% if (show_date_added_on_search) %}{{ post['date_added'] }}<br/>{% endif %}
                  {% if (show_description_on_search and post['short_description']) %}
                    <div class="description">{{ post['short_description'] }}</div>
                  {% endif %}
                  {% if (show_count_comments_on_search) %}
                    <i class="fa fa-comment-o" aria-hidden="true"></i> {{ post['comments'] }}&nbsp;&nbsp;
                  {% endif %}
                  {% if (show_count_viewed_on_search) %}
                    <i class="fa fa-eye" aria-hidden="true"></i> {{ post['viewed'] }}<br/>
                  {% endif %}
                  {% if (show_read_more_button_on_search) %}
                    <a href="{{ post['href'] }}">{{ text_button_readmore }} <i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
        <div class="row">
          {% if (show_pagination_results_on_search) %}
            <div class="col-sm-6 text-left">{{ pagination }}</div>
            <div class="col-sm-6 text-right">{{ results }}</div>
          {% else %}
            <div class="col-sm-12 text-left">{{ pagination }}</div>
          {% endif %}
        </div>
      {% else %}
        <p>{{ text_empty_search }}</p>
      {% endif %}
      {{ content_bottom }}
    </div>
    {{ column_right }}
  </div>
</div>
<script>
  $('#button-search').bind('click', function () {
    url = 'index.php?route=extension/ocdevwizard/{{ _name }}/search';

    var search = $('#content input[name=\'search\']').prop('value');

    if (search) {
      url += '&{{ _code }}_search=' + encodeURIComponent(search);
    }

    var category_id = $('#content select[name=\'category_id\']').prop('value');

    if (category_id > 0) {
      url += '&{{ _code }}_category_id=' + encodeURIComponent(category_id);
    }

    var sub_category = $('#content input[name=\'sub_category\']:checked').prop('value');

    if (sub_category) {
      url += '&{{ _code }}_sub_category=true';
    }

    var filter_description = $('#content input[name=\'description\']:checked').prop('value');

    if (filter_description) {
      url += '&{{ _code }}_description=true';
    }

    location = url;
  });

  $('#content input[name=\'search\']').bind('keydown', function (e) {
    if (e.keyCode == 13) {
      $('#button-search').trigger('click');
    }
  });

  $('select[name=\'category_id\']').on('change', function () {
    if (this.value == '0') {
      $('input[name=\'sub_category\']').prop('disabled', true);
    } else {
      $('input[name=\'sub_category\']').prop('disabled', false);
    }
  });

  $('select[name=\'category_id\']').trigger('change');
</script>
{% if (allow_schema_on_post) %}i
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
    {% set b_i = 1 %}
    {% for breadcrumb in breadcrumbs %}
      {
        "@type": "ListItem",
        "position": {{ b_i }},
        "name": "{{ breadcrumb['text'] }}",
        "item": "{{ breadcrumb['href'] }}"
      }{% if (b_i < (breadcrumbs|length)) %},{% endif %}
      {% set b_i = b_i + 1 %}
    {% endfor %}
    ]
  }
  </script>
  {% if (posts) %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "itemListElement": [
        {% set p_i = 1 %}
        {% for post in posts %}
        {
          "@type":"ListItem",
          "position": "{{ p_i }}",
          "url":"{{ post['href'] }}",
          "name": "{{ post['name'] }}"
        }{% if (p_i < (posts|length)) %},{% endif %}
        {% set p_i = p_i + 1 %}
        {% endfor %}
      ]
    }
  </script>
  {% endif %}
{% endif %}
{{ footer }}